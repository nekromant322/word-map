databaseChangeLog:
  - changeSet:
      id: create-grid-table
      author: Alex_Kolosov
      changes:
        - sql:
            dbms: postgresql
            sql: |
              CREATE SEQUENCE IF NOT EXISTS grid_id_seq START 1;
              
              CREATE TABLE grid (
                id BIGINT NOT NULL DEFAULT nextval('grid_id_seq'),
                world_id BIGINT NOT NULL,
                point geometry(Point, 0),
                letter CHAR(1),
                platform_id BIGINT NOT NULL,
                user_id BIGINT,
                tile_id SMALLINT,
                letter_id SMALLINT,
                CONSTRAINT pk_grid PRIMARY KEY (id, world_id),
                CONSTRAINT fk_platform FOREIGN KEY (platform_id) REFERENCES platforms(id),
                CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES users(id),
                CONSTRAINT fk_tile FOREIGN KEY (tile_id) REFERENCES tiles(id),
                CONSTRAINT fk_letter FOREIGN KEY (letter_id) REFERENCES letters(id),
                CONSTRAINT fk_world FOREIGN KEY (world_id) REFERENCES worlds(id)
              ) PARTITION BY LIST (world_id);
